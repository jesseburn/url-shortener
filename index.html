<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Shortly</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
        integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <link rel="stylesheet" href="./mainstyles.css" type="text/css">
    <script src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/garlic.js/1.4.2/garlic.min.js"></script>
</head>

<body>
    <header>
        <nav class="navbar">
            <div class="navbar-left">
                <img src="./images/logo.svg" alt="Shortly" class="logo">
                <i class="fas fa-bars"></i>
            </div>
            <div class="navbar-right">
                <a href="#null" class="navbar-right-links">Features</a>
                <a href="#null" class="navbar-right-links">Pricing</a>
                <a href="#null" class="navbar-right-links">Resources</a>
                <a href="#null" class="navbar-right-login">Login</a>
                <button class="navbar-right-btn">Sign Up</button>
            </div>
        </nav>
    </header>
    <section class="section1">
        <div class="section1-left">
            <h1 class="section1-left-h1"><strong>More than just shorter links</strong></h1>
            <p class="section1-left-p">Build your brand's recognition and get
                detailed insights on how your links are performing.</p>
            <button class="section1-left-btn">Get Started</button>
        </div>
        <aside class="section1-right">
            <!--section1-img is right on desktop-->
            <img src="./images/illustration-working.svg" aria-label="woman working at computer"
                alt="illustration-working" class="section1-right-img">
        </aside>
    </section>
    <section class="section2">
        <form id="form">
            <input type="text" name="shorten" placeholder="Shorten a link here..." id="form-text">
            <p id="error">Please add a link</p>
            <button type="submit" id="form-btn">Shorten It!</button>
            <div id="result"></div>
        </form>
    </section>
    <section class="section3">
        <h2 class="section3-h2"><strong>Advanced Statistics</strong></h2>
        <p class="section3-p">Track how your links are performing across
            the web with our advanced statistics dashboard.</p>
        <div class="section3-blocks">
            <section class="section3-block1">
                <img src="./images/icon-brand-recognition.svg" class="section3-icon1">
                <h3 class="section3-block1-h3">Brand Recognition</h3>
                <p class="section3-block1-p">Boost your brand recognition with each click. Generic links don't
                    mean a thing. Branded links help instil confidence in your content.</p>
            </section>
            <section class="section3-block2">
                <img src="./images/icon-detailed-records.svg" class="section3-icon2">
                <h3 class="section3-block2-h3">Detailed Records</h3>
                <p class="section3-block2-p">Gain insights into who is clicking your links. Knowing when and
                    where people engage with your content helps inform better decisions.</p>
            </section>
            <section class="section3-block3">
                <img src="./images/icon-fully-customizable.svg" class="section3-icon3">
                <h3 class="section3-block3-h3">Fully Custiomizable</h3>
                <p class="section3-block3-p">Improve brand awareness and content discoverability through
                    customizable links, supercharging audience engagement.</p>
            </section>
        </div>
    </section>
    <section class="section4">
        <h2 class="section4-h2"><strong>Boost your links today</strong></h2>
        <button class="section4-btn">Get Started</button>
    </section>
    <footer>
        <img src="./images/white-logo.svg" alt="Shortly" class="white-logo">
        <div class="footer-columns">
            <a href="#null" class="footer-columns-links">Features</a>
            <a href="#null" class="footer-columns-sublinks">Link Sharing</a>
            <a href="#null" class="footer-columns-sublinks">Branded Links</a>
            <a href="#null" class="footer-columns-sublinks">Analytics</a>
        </div>
        <div class="footer-columns">
            <a href="#null" class="footer-columns-links">Resources</a>
            <a href="#null" class="footer-columns-sublinks">Blog</a>
            <a href="#null" class="footer-columns-sublinks">Developers</a>
            <a href="#null" class="footer-columns-sublinks">Support</a>
        </div>
        <div class="footer-columns column3">
            <a href="#null" class="footer-columns-links">Company</a>
            <a href="#null" class="footer-columns-sublinks">About</a>
            <a href="#null" class="footer-columns-sublinks">Our Team</a>
            <a href="#null" class="footer-columns-sublinks">Careers</a>
            <a href="#null" class="footer-columns-sublinks">Contact</a>
        </div>
        <div class="footer-social-media">
            <i class="fab fa-facebook-square"></i>
            <i class="fab fa-twitter"></i>
            <i class="fab fa-pinterest"></i>
            <i class="fab fa-instagram"></i>
        </div>
    </footer>
    <script async defer>
        $(document).ready(function () {
            // https://rel.ink/api/links/

            $("#form-btn").on("click", function (e) {
                $(form).garlic();

                e.preventDefault();
                let result = document.getElementById("result");;
                let api_url = 'https://rel.ink/api/links/';

                /* https://googlechrome.github.io/samples/fetch-api/fetch-post.html
                    Fetch API post request to get information for url shortener */
                fetch(api_url, {
                    method: 'POST',
                    body: JSON.stringify({ url: $("#form-text").val() }),
                    headers: {
                        'Content-Type': 'application/json',
                    }
                }).then(response => {
                    // if the res if 400 the error message will display
                    if (response.status == 400) {
                        $("#form-text").css("border", "3px solid hsl(0, 94%, 66%)");
                        $("#error").css("display", "block");
                        $("#form-text").focus();
                        return;
                    } else {
                        $("#error").css("display", "none");
                        $("#form-text").css("border", "none");
                        $("#form-text").focus();
                        return response.json();
                    }
                })
                    // promises returned create output box for shortened url along with a copy btn
                    .then(data => {
                        if (data === undefined) {
                            return;
                        }

                        let output = document.createElement("div");
                        const outputBox = document.createElement("input");
                        const shortUrl = document.createElement("input");
                        const copyBtn = document.createElement("button");

                        $(copyBtn).attr({
                            "type": "button",
                            "data-clipboard-target": "#copy-target",
                            "class": "copy-btn",
                            "id": "copy-button"
                        });
                        $(output).attr({
                            "class": "output",
                            "readonly": true
                        });
                        $(outputBox).attr({
                            "class": "output-box",
                            "readonly": true
                        });
                        $(shortUrl).attr({
                            "class": "short-url",
                            "id": "copy-target",
                            "readonly": true
                        });
                        copyBtn.textContent = "Copy";
                        //console.log(data);
                        outputBox.value = `${$("#form-text").val()}`;
                        shortUrl.value = `https://rel.ink/${data.hashid}`;
                        output.appendChild(outputBox);
                        output.appendChild(shortUrl);
                        output.appendChild(copyBtn);
                        result.appendChild(output);

                        // styles for output and btn
                        $(".section3").append('<style type="text/css">@media screen and (max-width: 800px){ .section3 { padding-top: 69%}}</style>');

                        $(".output").css({
                            "width": "98%",
                            "height": "3rem",
                            "display": "flex",
                            "justify-content": "space-between",
                            "background-color": "#ffffff",
                            "align-items": "center",
                            "position": "absolute",
                            "top": "130%",
                            "left": "0",
                            "padding": "1%",
                            "border-radius": "9px"
                        });
                        $(".output-box").css({
                            "width": "45%",
                            "border": "none",
                            "font-size": "1rem"
                        });
                        $(".short-url").css({
                            "width": "20%",
                            "border": "none",
                            "font-size": "1rem",
                            "color": "hsl(180, 66%, 49%)"
                        });
                        $(".copy-btn").css({
                            "background-color": "hsl(180, 66%, 49%)",
                            "width": "7rem",
                            "height": "2.5rem",
                            "color": "#ffffff",
                            "border": "none",
                            "border-radius": "9px",
                            "font-size": "1rem"
                        });
                        // copy btn
                        $(copyBtn).on("click", function (e) {
                            $(copyBtn).css("background-color", "hsl(257, 27%, 26%)");
                            e.target.innerHTML = "Copied!";
                            //console.log("you copied it!");

                            let timeout = setTimeout(function () {
                                $(copyBtn).css("background-color", "hsl(180, 66%, 49%)");
                                copyBtn.textContent = "Copy";
                                //console.log(e.target);
                            }, 300)
                            new ClipboardJS("#copy-button");
                        });

                    }).catch(
                        error => {
                            console.log(error);
                        }
                    )
            });

            // mobile nav
            $(".fas").on("click", function () {
                $(".navbar-right").toggleClass("mobile-nav");
            });

        });

        // local storage
        $(window).on("load", function (e) {
            setTimeout(function () {
                if (localStorage.key(0) != null) {
                    $("#form-btn").click();
                } else {
                    console.log("You need local storage");
                }
            }, 10);
        });
    </script>
</body>

</html>